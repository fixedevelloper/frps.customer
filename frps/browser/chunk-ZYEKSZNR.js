import{a as Me}from"./chunk-XAMWYVB7.js";import{a as te}from"./chunk-P3CDBXS4.js";import"./chunk-F6PIM6T6.js";import{e as M,g as Y,h as ee}from"./chunk-FP5RNUBM.js";import{i as he,k as D,s as U}from"./chunk-JUECCOZU.js";import{a as T}from"./chunk-NJGTMJYU.js";import{j as Ce,k as Ie,l as we,m as Fe,n as De,o as Te,p as Pe,q as Oe}from"./chunk-OFPKGJW4.js";import{Ab as s,Ba as h,Bb as fe,Ca as b,Jb as t,Kb as e,Lb as u,Mb as ce,Nb as ue,Pb as P,Rc as J,Sc as I,Tb as S,Tc as w,Ub as p,Wc as O,Xb as G,Xc as K,Yc as _e,Zc as F,ac as xe,bb as X,bc as i,cb as ve,cc as g,dc as _,ec as E,fc as Q,gb as a,gc as H,gd as k,hb as f,hc as Z,hd as V,id as z,jc as C,jd as A,kc as L,kd as be,ld as Se,ma as pe,md as j,nc as v,nd as ie,oc as $,od as ne,pc as x,pd as re,qd as oe,rd as ae,sa as y,sd as le,td as Ee,ud as ye,va as ge,vb as c,vd as B,wd as q}from"./chunk-UFDMT6OF.js";import"./chunk-EQDQRRRY.js";var Be=r=>["/orders/delivery",r],qe=r=>["/orders/return",r];function Ue(r,l){r&1&&(t(0,"li"),u(1,"hr",36),e())}function Ge(r,l){if(r&1&&(t(0,"li")(1,"a",37),i(2,"Livraison"),e()()),r&2){let n=p().$implicit;a(),s("routerLink",L(1,Be,n.id))}}function $e(r,l){if(r&1&&(t(0,"li")(1,"a",37),i(2," Demander un retour "),e()()),r&2){let n=p().$implicit;a(),s("routerLink",L(1,qe,n.id))}}function We(r,l){if(r&1){let n=P();t(0,"tr")(1,"td")(2,"div",15),u(3,"input",24)(4,"label",25),e()(),t(5,"td")(6,"div",26)(7,"div"),u(8,"img",27),e(),t(9,"div")(10,"a",28),i(11),e()()()(),t(12,"td"),i(13),v(14,"date"),e(),t(15,"td"),i(16),v(17,"xafCurrency"),e(),t(18,"td")(19,"span",29),i(20),e()(),t(21,"td")(22,"div",30)(23,"div",31),u(24,"button",32),t(25,"ul",33)(26,"li")(27,"a",34),S("click",function(){let d=h(n).$implicit,m=p();return b(m.onView(d))}),i(28,"Detail"),e()(),c(29,Ue,2,0,"li",35)(30,Ge,3,3,"li",35),t(31,"li"),u(32,"hr",36),e(),c(33,$e,3,3,"li",35),e()()()()()}if(r&2){let n=l.$implicit,o=l.index,d=p();a(3),G("id","customCheck",o,""),a(),G("for","customCheck",o,""),a(4),s("src",n.customer_image,X),a(3),g(n.customer_name),a(2),g($(14,13,n.date)),a(3),g($(17,15,n.total)),a(3),s("ngClass",d.getStatusClass(n.status)),a(),g(n.status),a(9),s("ngIf",n.status!="En attente"),a(),s("ngIf",n.status!="En attente"),a(3),s("ngIf",n.status=="Livr\xE9")}}function Xe(r,l){r&1&&i(0,"Previous")}function Qe(r,l){r&1&&i(0,"Next")}var Ne=(()=>{let l=class l{constructor(o,d,m){this.apiService=o,this.toastService=d,this.router=m,this.orders=[],this.filteredOrderModels=[],this.searchText="",this.currentPage=1,this.pageSize=5,this.totalItems=0}ngOnInit(){this.loadItems()}getStatusClass(o){return{Success:"bg-success",Processing:"bg-primary",Rejected:"bg-danger",Pending:"bg-warning"}[o]||"bg-secondary"}loadItems(){this.apiService.getOrders(this.currentPage,this.pageSize).subscribe(o=>{this.orders=o.data,this.totalItems=o.total,this.currentPage=o.current_page,this.filteredOrderModels=[...this.orders]})}filterItems(){this.filteredOrderModels=this.orders.filter(o=>o.customer_name.toLowerCase().includes(this.searchText.toLowerCase())||o.status?.toLowerCase().includes(this.searchText.toLowerCase())),this.currentPage=1}onPageChange(o){this.currentPage=o,this.loadItems()}onView(o){this.toastService.success(`Voir commade : ${o.id}`),this.router.navigate(["/orders",o.id])}onEdit(o){console.log("Modifier cat\xE9gorie",o),this.router.navigate(["/categories/edit",o.id])}onDelete(o){confirm(`Confirmer la suppression de la cat\xE9gorie "${o.commande_id}" ?`)&&this.apiService.deleteAgent(o.id).subscribe({next:()=>{this.toastService.success("Cat\xE9gorie supprim\xE9e"),this.loadItems()},error:d=>{console.error(d),this.toastService.error("Erreur lors de la suppression")}})}};l.\u0275fac=function(d){return new(d||l)(f(D),f(U),f(Y))},l.\u0275cmp=y({type:l,selectors:[["app-orders"]],standalone:!0,features:[C],decls:44,vars:5,consts:[["title","Commades","subTitle","Mes Commades"],[1,"row"],[1,"col-xl-12"],[1,"card"],[1,"card-header","d-flex","justify-content-between","align-items-center","border-bottom"],[1,"card-title"],["ngbDropdown",""],["ngbDropdownToggle","","role","button",1,"btn","btn-sm","btn-outline-light","rounded"],["ngbDropdownMenu","",1,"dropdown-menu-end"],["href","javascript:void(0);",1,"dropdown-item"],[1,"card-body","p-0"],[1,"table-responsive"],[1,"table","align-middle","text-nowrap","table-hover","table-centered","mb-0"],[1,"bg-light-subtle"],[2,"width","20px"],[1,"form-check"],["type","checkbox","id","customCheck1",1,"form-check-input"],["for","customCheck1",1,"form-check-label"],[4,"ngFor","ngForOf"],[1,"card-footer","border-top"],["aria-label","Page navigation example"],[1,"pagination","justify-content-end","mb-0",3,"pageChange","collectionSize","page","pageSize"],["ngbPaginationPrevious",""],["ngbPaginationNext",""],["type","checkbox",1,"form-check-input",3,"id"],[1,"form-check-label",3,"for"],[1,"d-flex","align-items-center","gap-2"],["alt","",1,"avatar-sm","rounded-circle",3,"src"],["href","javascript:void(0);",1,"text-dark","fw-medium","fs-15"],[1,"badge","text-white","fs-11",3,"ngClass"],[1,"d-flex","flex-wrap","gap-2","mb-3"],["ngbDropdown","",1,"dropdown"],["type","button","ngbDropdownToggle","",1,"btn","btn-primary","dropdown-toggle"],["ngbDropdownMenu","",1,"dropdown-menu"],["href","javascript:void(0);",1,"dropdown-item",3,"click"],[4,"ngIf"],[1,"dropdown-divider"],["href","javascript:void(0);",1,"dropdown-item",3,"routerLink"]],template:function(d,m){d&1&&(u(0,"app-page-title",0),t(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div")(6,"h4",5),i(7,"Mes Commandes"),e()(),t(8,"div",6)(9,"a",7),i(10," This Month "),e(),t(11,"div",8)(12,"a",9),i(13,"Download"),e(),t(14,"a",9),i(15,"Export"),e(),t(16,"a",9),i(17,"Import"),e()()()(),t(18,"div",10)(19,"div",11)(20,"table",12)(21,"thead",13)(22,"tr")(23,"th",14)(24,"div",15),u(25,"input",16)(26,"label",17),e()(),t(27,"th"),i(28,"Client"),e(),t(29,"th"),i(30,"Date"),e(),t(31,"th"),i(32,"Total"),e(),t(33,"th"),i(34,"Status"),e(),t(35,"th"),i(36,"Action"),e()()(),t(37,"tbody"),c(38,We,34,17,"tr",18),e()()()(),t(39,"div",19)(40,"nav",20)(41,"ngb-pagination",21),Z("pageChange",function(R){return H(m.currentPage,R)||(m.currentPage=R),R}),S("pageChange",function(R){return m.onPageChange(R)}),c(42,Xe,1,0,"ng-template",22)(43,Qe,1,0,"ng-template",23),e()()()()()()),d&2&&(a(38),s("ngForOf",m.filteredOrderModels),a(3),s("collectionSize",30)("collectionSize",m.totalItems),Q("page",m.currentPage),s("pageSize",m.pageSize))},dependencies:[T,Fe,we,Ie,Ce,Oe,Pe,De,Te,F,J,I,w,O,Me,ee],encapsulation:2});let r=l;return r})();var Re=(()=>{let l=class l{constructor(o){this.sanitizer=o}transform(o){return this.sanitizer.bypassSecurityTrustResourceUrl(o)}};l.\u0275fac=function(d){return new(d||l)(f(he,16))},l.\u0275pipe=ge({name:"safeUrl",type:l,pure:!0,standalone:!0});let r=l;return r})();var He=r=>({"is-invalid":r});function Ze(r,l){if(r&1&&(t(0,"tr")(1,"td"),i(2),e(),t(3,"td"),i(4),v(5,"number"),e(),t(6,"td"),i(7),e(),t(8,"td",14),i(9),v(10,"number"),e()()),r&2){let n=l.$implicit,o=p(2);a(2),g(n.product),a(2),E("",x(5,6,n.product_price,"1.2-2")," ",o.currency,""),a(3),g(n.quantity),a(2),E("",x(10,9,o.getTotalPrice(n),"1.2-2")," ",o.currency,"")}}function Je(r,l){if(r&1&&(t(0,"div",4)(1,"header",5)(2,"div",6)(3,"div",7),u(4,"i",8),t(5,"b"),i(6),v(7,"date"),e(),u(8,"br"),t(9,"small",9),i(10),e()()()(),t(11,"div",10)(12,"div",11)(13,"table",12)(14,"thead",13)(15,"tr")(16,"th"),i(17,"Produit"),e(),t(18,"th"),i(19,"Prix Unitaire"),e(),t(20,"th"),i(21,"Quantit\xE9"),e(),t(22,"th",14),i(23,"Total"),e()()(),t(24,"tbody"),c(25,Ze,11,12,"tr",15),e()()(),t(26,"div",16)(27,"div",17)(28,"p")(29,"strong"),i(30,"Statut :"),e(),t(31,"span",9),i(32),e()(),t(33,"h6",9),i(34,"Notes:"),e(),t(35,"small",9),i(36,"Aucune note"),e()(),t(37,"div",18)(38,"p")(39,"strong"),i(40,"Sous-total :"),e(),i(41),v(42,"number"),e(),t(43,"p")(44,"strong"),i(45,"Remise (10%) :"),e(),i(46),v(47,"number"),e(),t(48,"h3"),i(49),v(50,"number"),e()()()()()),r&2){let n=p();a(6),g(x(7,10,n.order.date,"full")),a(4),_("Commande #",n.order.id,""),a(15),s("ngForOf",n.order.items),a(7),g(n.order.status),a(9),E(" ",x(42,13,n.order.total,"1.2-2")," ",n.currency,""),a(5),E(" ",x(47,16,0,"1.2-2")," ",n.currency,""),a(3),E("Total : ",x(50,19,n.order.total,"1.2-2")," ",n.currency,"")}}function Ke(r,l){if(r&1&&(t(0,"div",10),u(1,"iframe",23),v(2,"safeUrl"),e()),r&2){let n=p(2);a(),s("src",$(2,1,n.order.proforma_pdf),ve)}}function Ye(r,l){if(r&1&&(ce(0),t(1,"div",19)(2,"div",20)(3,"h4",21),i(4,"Proforma"),e()(),c(5,Ke,3,3,"div",22),e(),ue()),r&2){let n=p();a(5),s("ngIf",n.order.proforma_pdf)}}function et(r,l){if(r&1&&(t(0,"tr")(1,"td"),i(2),e(),t(3,"td"),i(4),v(5,"date"),e(),t(6,"td"),i(7),v(8,"number"),e(),t(9,"td"),i(10),e()()),r&2){let n=l.$implicit,o=l.index,d=p(3);a(2),g(o+1),a(2),g(x(5,5,n.date,"short")),a(3),E("",x(8,8,n.amount,"1.2-2")," ",d.currency,""),a(3),g(n.method)}}function tt(r,l){if(r&1&&(t(0,"div",37)(1,"table",38)(2,"thead",39)(3,"tr")(4,"th"),i(5,"#"),e(),t(6,"th"),i(7,"Date"),e(),t(8,"th"),i(9,"Montant"),e(),t(10,"th"),i(11,"M\xE9thode"),e()()(),t(12,"tbody"),c(13,et,11,11,"tr",15),e()()()),r&2){let n=p(2);a(13),s("ngForOf",n.order.payments)}}function it(r,l){if(r&1){let n=P();ce(0),t(1,"div",19)(2,"div",20)(3,"h4",21),i(4,"Paiements"),e()(),t(5,"div",10)(6,"form",24),S("ngSubmit",function(){h(n);let d=p();return b(d.onPayd())}),t(7,"div",25)(8,"div",26)(9,"label",27),i(10,"M\xE9thode de paiement"),e(),t(11,"select",28)(12,"option",29),i(13,"MTN Mobile Money"),e(),t(14,"option",30),i(15,"Orange Mobile Money"),e(),t(16,"option",31),i(17,"Carte bancaire"),e()(),t(18,"div",32),i(19,"Champ requis"),e()(),t(20,"div",26)(21,"label",27),i(22,"Montant"),e(),u(23,"input",33),e(),t(24,"div",34)(25,"button",35),i(26,"Payer"),e()()()(),c(27,tt,14,1,"div",36),e()(),ue()}if(r&2){let n,o=p();a(6),s("formGroup",o.paymentForm),a(5),s("ngClass",L(3,He,((n=o.paymentForm.get("methodPayment"))==null?null:n.touched)&&((n=o.paymentForm.get("methodPayment"))==null?null:n.invalid))),a(16),s("ngIf",o.order.payments==null?null:o.order.payments.length)}}function nt(r,l){r&1&&(t(0,"div",40),u(1,"div",41),t(2,"p"),i(3,"Chargement de la commande..."),e()())}var ke=(()=>{let l=class l{constructor(o,d){this.route=o,this.orderService=d,this.currency=te,this.fb=pe(ye),this.toastService=pe(U),this.paymentForm=this.fb.group({order_id:[this.orderId,[]],amount:["",[V.required]],methodPayment:["",[V.required]]})}get form(){return this.paymentForm.controls}ngOnInit(){this.orderId=+this.route.snapshot.paramMap.get("id"),this.fetchOrder()}fetchOrder(){this.orderService.getOrderById(this.orderId).subscribe(o=>{this.order=o.data})}getTotalPrice(o){return o.quantity*o.product_price}onPayd(){if(this.paymentForm.valid){let o=this.paymentForm.value;o.order_id=this.orderId,this.orderService.makePayment(o).subscribe({next:d=>{this.toastService.success("Paiemnet effectue avec success"),this.fetchOrder()},error:d=>{console.error(d),this.toastService.error("Erreur lors de l'ajout "+d.error.message)}})}}};l.\u0275fac=function(d){return new(d||l)(f(M),f(D))},l.\u0275cmp=y({type:l,selectors:[["app-order-detail"]],standalone:!0,features:[C],decls:5,vars:6,consts:[["title","Commades",3,"subTitle"],["class","card",4,"ngIf"],[4,"ngIf"],["class","text-center my-5",4,"ngIf"],[1,"card"],[1,"card-header"],[1,"row","align-items-center"],[1,"col-md-6"],[1,"material-icons","md-calendar_today"],[1,"text-muted"],[1,"card-body"],[1,"table-responsive","mt-3"],[1,"table","table-borderless","text-nowrap","mb-0"],[1,"bg-light","bg-opacity-50"],[1,"text-end"],[4,"ngFor","ngForOf"],[1,"row","mt-3"],[1,"col-md-7"],[1,"col-md-5","text-end"],[1,"card","mt-4"],[1,"card-header","d-flex","justify-content-between","align-items-center"],[1,"card-title"],["class","card-body",4,"ngIf"],["width","100%","height","600px",3,"src"],[3,"ngSubmit","formGroup"],[1,"row","g-3","align-items-end"],[1,"col-md-5"],[1,"form-label"],["formControlName","methodPayment",1,"form-select",3,"ngClass"],["value","2"],["value","3"],["value","4"],[1,"invalid-feedback"],["type","text","formControlName","amount","placeholder","Montant",1,"form-control","bg-light","bg-opacity-50","border-light","py-2"],[1,"col-md-2","text-end"],["type","submit",1,"btn","btn-danger","w-100"],["class","table-responsive mt-4",4,"ngIf"],[1,"table-responsive","mt-4"],[1,"table","table-bordered"],[1,"bg-light"],[1,"text-center","my-5"],["role","status",1,"spinner-border","text-primary"]],template:function(d,m){d&1&&(u(0,"app-page-title",0),c(1,Je,51,22,"div",1)(2,Ye,6,1,"ng-container",2)(3,it,28,5,"ng-container",2)(4,nt,4,0,"div",3)),d&2&&(G("subTitle","D\xE9tail de la commande #",m.order==null?null:m.order.id,""),a(),s("ngIf",m.order),a(),s("ngIf",m.order&&m.order.status!=="En attente"),a(),s("ngIf",m.order&&m.order.status!=="En attente"),a(),s("ngIf",!m.order))},dependencies:[T,Re,q,j,oe,ae,k,re,z,A,ie,ne,B,F,J,I,w,K,O]});let r=l;return r})();var rt=r=>["/orders",r,"issue"];function ot(r,l){if(r&1&&(t(0,"li",20),i(1),t(2,"span"),i(3),v(4,"number"),e()()),r&2){let n=l.$implicit,o=p(3);a(),E(" ",n.product," (x",n.quantity,") "),a(2),E("",x(4,4,n.product_price,"1.2-2")," ",o.currency,"")}}function at(r,l){if(r&1&&(t(0,"div",21)(1,"a",22),i(2," Signaler un probl\xE8me "),e()()),r&2){let n=p(3);a(),s("routerLink",L(1,rt,n.order.id))}}function lt(r,l){if(r&1&&(t(0,"li",26)(1,"strong"),i(2,"Motif : "),e(),i(3),u(4,"br"),t(5,"strong"),i(6,"Statut : "),e(),i(7),u(8,"br"),t(9,"strong"),i(10,"Commentaire : "),e(),i(11),e()),r&2){let n=l.$implicit;a(3),g(n.motif),a(4),g(n.status),a(4),_("",n.commentaire," ")}}function dt(r,l){if(r&1&&(t(0,"div",23)(1,"div",24),i(2,"\u26A0\uFE0F Litiges"),e(),t(3,"ul",10),c(4,lt,12,3,"li",25),e()()),r&2){let n=p(3);a(4),s("ngForOf",n.order.litiges)}}function mt(r,l){if(r&1&&(t(0,"div",4)(1,"div",5)(2,"h2",6),i(3),e()(),t(4,"div",7)(5,"div",8)(6,"div",9),i(7,"\u{1F4E6} Produits command\xE9s"),e(),t(8,"div",7)(9,"ul",10),c(10,ot,5,7,"li",11),t(11,"li",12)(12,"strong"),i(13),v(14,"number"),e()()()(),c(15,at,3,3,"div",13),e(),t(16,"div",8)(17,"div",14),i(18,"\u{1F69A} Adresse de livraison"),e(),t(19,"div",7)(20,"p",15),i(21),e(),t(22,"p")(23,"strong"),i(24,"Statut : "),e(),i(25),e(),t(26,"p")(27,"strong"),i(28,"Livr\xE9 le : "),e(),i(29),e()()(),t(30,"div",8)(31,"div",16),i(32,"\u{1F4CD} Suivi de la commande"),e(),t(33,"div",7)(34,"div",17)(35,"div",18),i(36),e()()()(),c(37,dt,5,1,"div",19),e()()),r&2){let n=p(2);a(3),_("Commande #",n.order.id,""),a(7),s("ngForOf",n.order.items),a(3),E("Total : ",x(14,12,n.order.total,"1.2-2")," ",n.currency,""),a(2),s("ngIf",!n.loading&&n.order.status=="Livr\xE9"),a(6),g(n.order.delivery==null?null:n.order.delivery.address),a(4),g(n.order==null?null:n.order.status),a(4),g((n.order.delivery==null?null:n.order.delivery.delivered_at)||"En cours..."),a(6),fe("width",n.getTrackingProgress(n.order.delivery==null?null:n.order.delivery.status)),a(),_(" ",n.order.delivery==null?null:n.order.delivery.status," "),a(),s("ngIf",n.order.litiges==null?null:n.order.litiges.length)}}function st(r,l){if(r&1&&(t(0,"div"),c(1,mt,38,15,"div",3),e()),r&2){let n=p();a(),s("ngIf",n.order&&!n.loading&&n.order.status=="En pr\xE9paration"||n.order.status=="Livr\xE9")}}function pt(r,l){r&1&&(t(0,"div",27)(1,"div",28)(2,"span",29),i(3,"Chargement..."),e()(),t(4,"p",30),i(5,"Chargement des d\xE9tails de la commande..."),e()())}var Ve=(()=>{let l=class l{constructor(o,d){this.route=o,this.orderService=d,this.loading=!0,this.currency=te}ngOnInit(){let o=this.route.snapshot.paramMap.get("id");o&&this.orderService.getOrderDetail(o).subscribe(d=>{this.order=d.data,this.loading=!1})}getTrackingProgress(o){switch(o){case"pr\xE9par\xE9e":return"25%";case"en cours de livraison":return"50%";case"livr\xE9e":return"100%";default:return"10%"}}};l.\u0275fac=function(d){return new(d||l)(f(M),f(D))},l.\u0275cmp=y({type:l,selectors:[["app-delivery"]],standalone:!0,features:[C],decls:3,vars:2,consts:[["title","Livraison","subTitle","Suivi livraison"],[4,"ngIf"],["class","text-center my-5",4,"ngIf"],["class","  card mt-1",4,"ngIf"],[1,"card","mt-1"],[1,"card-header"],[1,"mb-4"],[1,"card-body"],[1,"card","mb-4"],[1,"card-header","bg-primary","text-white"],[1,"list-group","list-group-flush"],["class","list-group-item d-flex justify-content-between align-items-center",4,"ngFor","ngForOf"],[1,"list-group-item","text-end"],["class","card-footer",4,"ngIf"],[1,"card-header","bg-success","text-white"],[1,"mb-1"],[1,"card-header","bg-info","text-white"],[1,"progress",2,"height","25px"],["role","progressbar",1,"progress-bar","progress-bar-striped","progress-bar-animated","bg-warning"],["class","card mb-4 border-danger",4,"ngIf"],[1,"list-group-item","d-flex","justify-content-between","align-items-center"],[1,"card-footer"],[1,"btn","btn-outline-danger","btn-sm",3,"routerLink"],[1,"card","mb-4","border-danger"],[1,"card-header","bg-danger","text-white"],["class","list-group-item",4,"ngFor","ngForOf"],[1,"list-group-item"],[1,"text-center","my-5"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"mt-3"]],template:function(d,m){d&1&&(u(0,"app-page-title",0),c(1,st,2,1,"div",1)(2,pt,6,0,"div",2)),d&2&&(a(),s("ngIf",m.order),a(),s("ngIf",m.loading))},dependencies:[T,F,I,w,K,ee]});let r=l;return r})();function ct(r,l){if(r&1){let n=P();t(0,"tr")(1,"td"),i(2),e(),t(3,"td"),i(4),v(5,"currency"),e(),t(6,"td"),i(7),e(),t(8,"td")(9,"button",9),S("click",function(){let d=h(n).$implicit,m=p();return b(m.selectItem(d))}),i(10," Retourner "),e()()()}if(r&2){let n=l.$implicit;a(2),g(n.product),a(2),g(x(5,3,n.product_price,"XAF")),a(3),g(n.quantity)}}function ut(r,l){if(r&1){let n=P();t(0,"div",10)(1,"div",11)(2,"strong"),i(3),e()(),t(4,"div",4)(5,"form",12,0),S("ngSubmit",function(){h(n);let d=p();return b(d.submitReturn())}),t(7,"div",13)(8,"label",14),i(9,"Motif du retour"),e(),t(10,"textarea",15),Z("ngModelChange",function(d){h(n);let m=p();return H(m.returnData.reason,d)||(m.returnData.reason=d),b(d)}),e()(),t(11,"button",16),i(12," Envoyer la demande "),e(),t(13,"button",17),S("click",function(){h(n);let d=p();return b(d.cancelReturn())}),i(14," Annuler "),e()()()()}if(r&2){let n=xe(6),o=p();a(3),_("Demande de retour pour ",o.selectedItem.product,""),a(7),Q("ngModel",o.returnData.reason),a(),s("disabled",!n.form.valid)}}var ze=(()=>{let l=class l{constructor(o,d){this.route=o,this.orderService=d,this.selectedItem=null,this.returnData={reason:""}}ngOnInit(){this.orderId=+this.route.snapshot.paramMap.get("id"),this.orderId&&this.orderService.getOrderById(this.orderId).subscribe(o=>{this.order=o.data})}selectItem(o){this.selectedItem=o,this.returnData={reason:""}}cancelReturn(){this.selectedItem=null,this.returnData={reason:""}}submitReturn(){let o={order_item_id:this.selectedItem.id,reason:this.returnData.reason,order_id:this.orderId.toString()};this.orderService.submitReturnRequest(o).subscribe(d=>{alert("Demande de retour envoy\xE9e avec succ\xE8s"),this.cancelReturn()})}};l.\u0275fac=function(d){return new(d||l)(f(M),f(D))},l.\u0275cmp=y({type:l,selectors:[["app-order-return"]],standalone:!0,features:[C],decls:37,vars:12,consts:[["returnForm","ngForm"],["title","Retour produits","subTitle","Demander un retour"],[1,"mt-4"],[1,"card","mb-4"],[1,"card-body"],[1,"table-responsive","mb-4"],[1,"table","table-bordered"],[4,"ngFor","ngForOf"],["class","card",4,"ngIf"],[1,"btn","btn-warning","btn-sm",3,"click"],[1,"card"],[1,"card-header","bg-light"],[3,"ngSubmit"],[1,"mb-3"],["for","reason",1,"form-label"],["id","reason","required","","name","reason","rows","3",1,"form-control",3,"ngModelChange","ngModel"],["type","submit",1,"btn","btn-primary",3,"disabled"],["type","button",1,"btn","btn-secondary","ms-2",3,"click"]],template:function(d,m){d&1&&(u(0,"app-page-title",1),t(1,"div",2)(2,"h3"),i(3),e(),t(4,"div",3)(5,"div",4)(6,"p")(7,"strong"),i(8,"Date :"),e(),i(9),v(10,"date"),e(),t(11,"p")(12,"strong"),i(13,"Total :"),e(),i(14),v(15,"currency"),e(),t(16,"p")(17,"strong"),i(18,"Status :"),e(),i(19),e()()(),t(20,"h5"),i(21,"Produits command\xE9s"),e(),t(22,"div",5)(23,"table",6)(24,"thead")(25,"tr")(26,"th"),i(27,"Produit"),e(),t(28,"th"),i(29,"Prix"),e(),t(30,"th"),i(31,"Quantit\xE9"),e(),t(32,"th"),i(33,"Action"),e()()(),t(34,"tbody"),c(35,ct,11,6,"tr",7),e()()(),c(36,ut,15,3,"div",8),e()),d&2&&(a(3),_("D\xE9tails de la commande #",m.order==null?null:m.order.id,""),a(6),_(" ",x(10,6,m.order==null?null:m.order.date,"medium"),""),a(5),_(" ",x(15,9,m.order==null?null:m.order.total,"XAF"),""),a(5),_(" ",m.order==null?null:m.order.status,""),a(16),s("ngForOf",m.order==null?null:m.order.items),a(),s("ngIf",m.selectedItem))},dependencies:[T,F,I,w,_e,O,q,j,k,z,A,le,B,Se,be]});let r=l;return r})();function gt(r,l){r&1&&(t(0,"div",11)(1,"label",29),i(2,"D\xE9tail de la non-conformit\xE9"),e(),u(3,"input",30),e())}function vt(r,l){if(r&1&&u(0,"img",33),r&2){let n=l.$implicit;s("src",n,X)}}function ft(r,l){if(r&1&&(t(0,"div",31),c(1,vt,1,1,"img",32),e()),r&2){let n=p(2);a(),s("ngForOf",n.imagePreviews)}}function xt(r,l){r&1&&(t(0,"div",34),i(1," Probl\xE8me signal\xE9 avec succ\xE8s ! Le support a \xE9t\xE9 notifi\xE9. "),e())}function _t(r,l){if(r&1){let n=P();t(0,"div",2)(1,"div",3)(2,"h4",4),i(3,"D\xE9tails de la commande"),e()(),t(4,"div",5)(5,"div",6)(6,"div",5),u(7,"h5",7),t(8,"strong"),i(9),e(),t(10,"ul",8)(11,"li")(12,"strong"),i(13,"Produit :"),e(),t(14,"span"),i(15),e()(),t(16,"li")(17,"strong"),i(18,"Statut :"),e(),t(19,"span",9),i(20),e()(),t(21,"li")(22,"strong"),i(23,"Date estim\xE9e :"),e(),t(24,"span"),i(25),v(26,"date"),e()()()()(),t(27,"h5"),i(28,"Signaler un probl\xE8me"),e(),t(29,"form",10),S("ngSubmit",function(){h(n);let d=p();return b(d.onSubmit())}),t(30,"div",11)(31,"label",12),i(32,"Type de probl\xE8me"),e(),t(33,"select",13)(34,"option",14),i(35,"-- Choisissez --"),e(),t(36,"option",15),i(37,"Retard anormal"),e(),t(38,"option",16),i(39,"Colis endommag\xE9"),e(),t(40,"option",17),i(41,"Produit non conforme"),e(),t(42,"option",18),i(43,"Produit defectueux"),e(),t(44,"option",19),i(45,"Erreur Livraison"),e(),t(46,"option",20),i(47,"Quantite Incorrecte"),e()()(),c(48,gt,4,0,"div",21),t(49,"div",11)(50,"label",22),i(51,"Description du probl\xE8me"),e(),u(52,"textarea",23),e(),t(53,"div",11)(54,"label",24),i(55,"Preuves (photo, capture, etc.)"),e(),t(56,"input",25),S("change",function(d){h(n);let m=p();return b(m.onFileChange(d))}),e(),c(57,ft,2,1,"div",26),e(),t(58,"button",27),i(59,"Envoyer la demande"),e()(),c(60,xt,2,0,"div",28),e()()}if(r&2){let n=p();a(9),_("Commande #",n.order==null?null:n.order.id,""),a(6),g((n.order==null||n.order.produit==null?null:n.order.produit.nom)||"\u2014"),a(5),g(n.order==null?null:n.order.status),a(5),g(x(26,9,n.order==null?null:n.order.date,"dd/MM/yyyy")),a(4),s("formGroup",n.returnForm),a(19),s("ngIf",n.returnForm.value.type==="non_conforme"),a(9),s("ngIf",n.imagePreviews.length>0),a(),s("disabled",!n.returnForm.valid),a(2),s("ngIf",n.submitted&&n.returnForm.valid)}}var Ae=(()=>{let l=class l{constructor(o,d,m,N,R){this.fb=o,this.orderService=d,this.route=m,this.toastService=N,this.router=R,this.imagePreviews=[],this.submitted=!1,this.order={},this.files=[],this.returnForm=this.fb.group({type:["",V.required],description:["",V.required],nonConformDetail:[""],orderId:[""]})}ngOnInit(){this.orderId=+this.route.snapshot.paramMap.get("id"),this.orderId&&this.orderService.getOrderById(this.orderId).subscribe(o=>{this.order=o.data})}onFileChange(o){let d=o.target;d.files&&d.files.length>0&&(this.files=Array.from(d.files),this.imagePreviews=[],this.files.forEach(m=>{let N=new FileReader;N.onload=()=>{this.imagePreviews.push(N.result)},N.readAsDataURL(m)})),console.log(this.imagePreviews)}onSubmit(){if(this.submitted=!0,this.returnForm.valid){let o=new FormData;o.append("type",this.returnForm.value.type),o.append("description",this.returnForm.value.description),o.append("order_id",this.orderId.toString()),this.files.forEach(d=>{o.append("proofs[]",d)}),this.orderService.submitLitige(o).subscribe(d=>{this.toastService.success("Probl\xE8me signal\xE9 avec succ\xE8s"),this.router.navigateByUrl("litiges/list")})}}};l.\u0275fac=function(d){return new(d||l)(f(Ee),f(D),f(M),f(U),f(Y))},l.\u0275cmp=y({type:l,selectors:[["app-return-request"]],standalone:!0,features:[C],decls:2,vars:1,consts:[["title","Litiges","subTitle","Signaler un probl\xE8me"],["class","card",4,"ngIf"],[1,"card"],[1,"card-header"],[1,"card-title"],[1,"card-body"],[1,"card","mb-3","shadow-sm","border-0"],[1,"card-title","mb-3"],[1,"list-unstyled","mb-0"],[1,"badge","bg-info","text-dark"],["enctype","multipart/form-data",3,"ngSubmit","formGroup"],[1,"mb-3"],["for","type",1,"form-label"],["formControlName","type","required","",1,"form-select"],["value",""],["value","retard"],["value","endommag\xE9"],["value","non_conformite"],["value","produit_defectueux"],["value","erreur_livraison"],["value","quantite_incorrecte"],["class","mb-3",4,"ngIf"],["for","description",1,"form-label"],["formControlName","description","rows","4","required","",1,"form-control"],["for","files",1,"form-label"],["type","file","accept","image/*","multiple","",1,"form-control",3,"change"],["class","mt-2 d-flex gap-2",4,"ngIf"],["type","submit",1,"btn","btn-danger",3,"disabled"],["class","alert alert-success mt-3",4,"ngIf"],[1,"form-label"],["formControlName","nonConformDetail","type","text","required","",1,"form-control"],[1,"mt-2","d-flex","gap-2"],["class","img-thumbnail","style","width: 80px;",3,"src",4,"ngFor","ngForOf"],[1,"img-thumbnail",2,"width","80px",3,"src"],[1,"alert","alert-success","mt-3"]],template:function(d,m){d&1&&(u(0,"app-page-title",0),c(1,_t,61,12,"div",1)),d&2&&(a(),s("ngIf",m.order))},dependencies:[T,q,j,oe,ae,k,re,z,A,le,ie,ne,B,F,I,w,O]});let r=l;return r})();var vi=[{path:"list",component:Ne,data:{title:"Commandes List"}},{path:":id",component:ke,data:{title:"Commandes Detail"}},{path:"delivery/:id",component:Ve,data:{title:"Commandes Livraison"}},{path:"return/:id",component:ze,data:{title:"Commandes Livraison"}},{path:":id/issue",component:Ae}];export{vi as ORDERS_ROUTES};
